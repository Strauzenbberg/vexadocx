<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEXA // PDF to DOCX Elite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://unpkg.com/docx@8.2.2/build/index.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        :root { 
            --primary: #007AFF; 
            --bg: #0a0a0b; 
            --card: #121214; 
            --border: #1c1c1e;
            --text: #ffffff; 
            --text-dim: #8e8e93;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: var(--bg); color: var(--text); 
            font-family: -apple-system, system-ui, sans-serif; 
            display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 40px 20px;
        }

        header { text-align: center; margin-bottom: 40px; }
        h1 { font-size: 48px; font-weight: 700; letter-spacing: -2px; }
        .sub-header { color: var(--text-dim); font-size: 14px; margin: 10px auto; }

        .upload-section { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 16px; }

        .drop-zone {
            background: var(--card); border: 1px dashed #2c2c2e; border-radius: 24px;
            padding: 45px 20px; text-align: center; cursor: pointer; transition: 0.3s;
        }
        .drop-zone.active { border-color: var(--primary); background: rgba(0, 122, 255, 0.05); }

        .btn {
            display: flex; align-items: center; justify-content: center;
            width: 100%; padding: 18px; border-radius: 16px; font-weight: 700;
            border: none; cursor: pointer; transition: 0.2s;
        }

        #btn-run { background: #fff; color: #000; margin-top: 10px; }
        #btn-run:disabled { background: #1c1c1e; color: #555; cursor: not-allowed; }

        #log {
            width: 100%; max-width: 400px; font-family: monospace; font-size: 11px;
            color: #00ff00; background: #000; padding: 15px; border-radius: 16px;
            margin-top: 20px; height: 130px; overflow-y: auto; border: 1px solid var(--border);
        }

        .support-card {
            width: 100%; max-width: 400px; background: var(--card); border-radius: 28px;
            padding: 30px; text-align: center; margin-top: 20px; border: 1px solid var(--border);
        }
        .btn-pix { background: var(--primary); color: white; margin-top: 15px; }
        input[type="file"] { display: none; }
    </style>
</head>
<body>

<header>
    <h1>VEXA</h1>
    <p class="sub-header">Conversão Profissional Local.<br>Privacidade Total e Código Limpo.</p>
</header>

<div class="upload-section">
    <div class="drop-zone" id="drop-zone">
        <h3>ARQUIVOS PDF</h3>
        <p>Clique ou arraste para converter</p>
    </div>
    <input type="file" id="f-pdf" accept=".pdf" multiple>
    <button id="btn-run" class="btn">CONVERTER PARA DOCX</button>
    <div id="log">> Motor VEXA pronto...</div>
</div>

<div class="support-card">
    <h3>Apoie o Projeto</h3>
    <button class="btn btn-pix" onclick="copyPix()">Copiar Chave PIX</button>
</div>

<script>
    const logDiv = document.getElementById('log');
    const btnRun = document.getElementById('btn-run');
    const fileInput = document.getElementById('f-pdf');
    const dropZone = document.getElementById('drop-zone');
    
    // Configuração do Worker do PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    const writeLog = (msg) => { 
        logDiv.innerHTML += `<div>> ${msg}</div>`; 
        logDiv.scrollTop = logDiv.scrollHeight; 
    };

    dropZone.onclick = () => fileInput.click();
    
    fileInput.onchange = () => {
        if(fileInput.files.length > 0) writeLog(`${fileInput.files.length} PDF(S) CARREGADO(S)`);
    };

    async function processFile(file) {
        try {
            const arrayBuffer = await file.arrayBuffer();
            const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
            const docSections = [];

            for (let i = 1; i <= pdf.numPages; i++) {
                writeLog(`EXTRAINDO PÁGINA ${i}...`);
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                const pageText = textContent.items.map(s => s.str).join(" ");

                // Criando parágrafos para o DOCX
                docSections.push(
                    new docx.Paragraph({
                        children: [new docx.TextRun(pageText)],
                        spacing: { after: 200 }
                    })
                );
            }

            // Gerando o documento DOCX real
            const doc = new docx.Document({
                sections: [{
                    properties: {},
                    children: docSections,
                }],
            });

            const blob = await docx.Packer.toBlob(doc);
            saveAs(blob, file.name.replace(".pdf", ".docx"));
            return true;
        } catch (error) {
            console.error(error);
            return false;
        }
    }

    btnRun.onclick = async () => {
        if (fileInput.files.length === 0) return writeLog("ERRO: NENHUM ARQUIVO");
        
        btnRun.disabled = true;
        btnRun.innerText = "GERANDO DOCX...";
        
        for (let file of fileInput.files) {
            writeLog(`ANALISANDO: ${file.name}`);
            const success = await processFile(file);
            if(success) writeLog(`SUCESSO: ${file.name.replace(".pdf", ".docx")}`);
            else writeLog(`FALHA TÉCNICA NO ARQUIVO: ${file.name}`);
        }

        writeLog("✨ TAREFAS CONCLUÍDAS!");
        btnRun.disabled = false;
        btnRun.innerText = "CONVERTER PARA DOCX";
    };

    function copyPix() {
        navigator.clipboard.writeText("153d672d-9acb-4fc9-90b9-42ad3a097709");
        writeLog("PIX COPIADO!");
    }
</script>
</body>
</html>
