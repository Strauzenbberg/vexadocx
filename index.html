<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VEXA // PDF to DOCX Elite</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html-docx-js/0.3.1/html-docx.js"></script>
    <style>
        :root { 
            --primary: #007AFF; 
            --bg: #0a0a0b; 
            --card: #121214; 
            --border: #1c1c1e;
            --text: #ffffff; 
            --text-dim: #8e8e93;
            --whatsapp: #25d366;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: var(--bg); color: var(--text); 
            font-family: -apple-system, system-ui, sans-serif; 
            display: flex; flex-direction: column; align-items: center; min-height: 100vh; padding: 40px 20px;
        }

        header { text-align: center; margin-bottom: 40px; }
        h1 { font-size: 48px; font-weight: 700; letter-spacing: -2px; }
        .sub-header { color: var(--text-dim); font-size: 14px; max-width: 320px; margin: 10px auto; }

        .upload-section { width: 100%; max-width: 400px; display: flex; flex-direction: column; gap: 16px; }

        .drop-zone {
            background: var(--card); border: 1px dashed #2c2c2e; border-radius: 24px;
            padding: 45px 20px; text-align: center; cursor: pointer; transition: 0.3s;
        }

        .drop-zone.active { border-color: var(--primary); background: rgba(0, 122, 255, 0.05); }

        .btn {
            display: flex; align-items: center; justify-content: center;
            width: 100%; padding: 18px; border-radius: 16px; font-weight: 700;
            border: none; cursor: pointer; transition: 0.2s;
        }

        #btn-run { background: #fff; color: #000; margin-top: 10px; }
        #btn-run:disabled { background: #1c1c1e; color: #555; }

        #log {
            width: 100%; max-width: 400px; font-family: monospace; font-size: 11px;
            color: #00ff00; background: #000; padding: 15px; border-radius: 16px;
            margin-top: 20px; height: 120px; overflow-y: auto; border: 1px solid var(--border);
        }

        .support-card {
            width: 100%; max-width: 400px; background: var(--card); border-radius: 28px;
            padding: 30px; text-align: center; margin-top: 20px; border: 1px solid var(--border);
        }

        .btn-pix { background: var(--primary); color: white; margin-top: 15px; }
        input[type="file"] { display: none; }
    </style>
</head>
<body>

<header>
    <h1>VEXA</h1>
    <p class="sub-header">Conversão Real de PDF para DOCX.<br>Processamento de texto local.</p>
</header>

<div class="upload-section">
    <div class="drop-zone" id="drop-zone">
        <h3>ARQUIVOS PDF</h3>
        <p>Clique ou arraste para converter</p>
    </div>
    <input type="file" id="f-pdf" accept=".pdf" multiple>
    <button id="btn-run" class="btn">CONVERTER PARA DOCX</button>
    <div id="log">> Aguardando documentos...</div>
</div>

<div class="support-card">
    <h3>Apoie o VEXA</h3>
    <p style="font-size: 13px; color: var(--text-dim); margin-top: 10px;">Mantenha esta ferramenta privada e gratuita.</p>
    <button class="btn btn-pix" onclick="copyPix()">Copiar Chave PIX</button>
</div>

<script>
    const logDiv = document.getElementById('log');
    const btnRun = document.getElementById('btn-run');
    const fileInput = document.getElementById('f-pdf');
    const dropZone = document.getElementById('drop-zone');
    
    // Configuração do PDF.js
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

    const writeLog = (msg) => { 
        logDiv.innerHTML += `<div>> ${msg}</div>`; 
        logDiv.scrollTop = logDiv.scrollHeight; 
    };

    dropZone.onclick = () => fileInput.click();
    
    fileInput.onchange = () => {
        if(fileInput.files.length > 0) writeLog(`${fileInput.files.length} PDF(S) NA FILA`);
    };

    async function convertPdfToDocx(file) {
        const reader = new FileReader();
        return new Promise((resolve) => {
            reader.onload = async function() {
                try {
                    const typedarray = new Uint8Array(this.result);
                    const pdf = await pdfjsLib.getDocument(typedarray).promise;
                    let fullText = "";

                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        const pageText = textContent.items.map(s => s.str).join(" ");
                        fullText += `<p>${pageText}</p>`;
                        writeLog(`PROCESSANDO PÁGINA ${i}...`);
                    }

                    // Transforma o HTML extraído em um arquivo .docx real
                    const docxContent = htmlDocx.asBlob(`<html><body>${fullText}</body></html>`);
                    const url = URL.createObjectURL(docxContent);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = file.name.replace(".pdf", ".docx");
                    a.click();
                    
                    resolve(true);
                } catch (e) {
                    console.error(e);
                    resolve(false);
                }
            };
            reader.readAsArrayBuffer(file);
        });
    }

    btnRun.onclick = async () => {
        if (fileInput.files.length === 0) return;
        btnRun.disabled = true;
        btnRun.innerText = "CONVERTENDO TEXTO...";
        
        for (let file of fileInput.files) {
            writeLog(`ANALISANDO: ${file.name}`);
            const success = await convertPdfToDocx(file);
            if(success) writeLog(`SUCESSO: ${file.name.replace(".pdf", ".docx")}`);
            else writeLog(`ERRO NO ARQUIVO: ${file.name}`);
        }

        writeLog("✨ CONVERSÃO FINALIZADA!");
        btnRun.disabled = false;
        btnRun.innerText = "CONVERTER PARA DOCX";
    };

    function copyPix() {
        navigator.clipboard.writeText("153d672d-9acb-4fc9-90b9-42ad3a097709");
        writeLog("PIX COPIADO!");
    }
</script>
</body>
</html>
